var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(){const e=document.createElement("div");e.classList.add("rate-bar");let t=.5;function n(){e.style.setProperty("--rate",t.toString())}function a(e){isFinite(e)&&(e<0?e=0:e>1&&(e=1),t=e,n())}return e.addEventListener("click",(t=>{a(t.offsetX/e.offsetWidth)})),n(),{element:e,getValue:function(){return t},setValue:a}}function a(e,t){return Math.exp(2*(e-.5)*Math.log(t))}function r(e,t){return Math.log(e)/Math.log(t)/2+.5}function s(e){isFinite(e)||(e=0);const t=Math.floor(e%3600/60).toString().padStart(2,"0")+":"+Math.floor(e%60).toString().padStart(2,"0");return e<=3600?t:Math.floor(e/3600).toString()+":"+t}e.d(t,{ky:()=>n,F_:()=>a,SM:()=>r,AS:()=>s,hM:()=>i});const o=["autoplay","controls","crossorigin","loop","muted","poster","preload"],i=async(e,t)=>{const i=document.createElement("div"),d=document.createElement("video"),l=document.createElement("div"),c=document.createElement("div"),p=document.createElement("div"),u=document.createElement("button"),m=n(),v=document.createElement("div"),y=n(),L=document.createElement("div"),g=n(),f=document.createElement("div");function h(e){const{seekable:t}=d;for(let n=0;n<t.length;n++)if(t.start(n)<=e&&e<=t.end(n))return d.currentTime=e,void(v.textContent=`${s(d.currentTime)}/${s(d.duration)}`)}i.append(d),i.append(l),l.append(c),l.append(p),c.append(u),c.append(m.element),c.append(v),p.append(new Text("Speed")),p.append(y.element),p.append(L),p.append(new Text("Brightness")),p.append(g.element),p.append(f),l.classList.add("hide"),u.classList.add("show-icon"),u.classList.add("play"),m.setValue(0),v.textContent=`${s(0)}/${s(0)}`,L.textContent="1.0",f.textContent="1.0";const{src:E,time:k}=e.options;"string"==typeof E&&(d.src=t.context.urlToAbsURL(E,e)),"number"==typeof k&&isFinite(k)&&k>0&&h(k);for(const n of o){let a=e.options[n]??t.context.extractLastGlobalOption(n,"player");if(!0===a&&(a=""),"string"==typeof a)try{d.setAttribute(n,a)}catch(e){console.log(e)}}function x(){const e=a(g.getValue(),10);d.style.setProperty("--brightness",e.toString()),f.textContent=e.toFixed(1)}d.addEventListener("click",(()=>{l.classList.toggle("hide")})),u.addEventListener("click",(async()=>{u.classList.contains("pushing")||(u.classList.add("pushing"),u.classList.contains("play")?await d.play():d.pause(),u.classList.remove("pushing"))})),m.element.addEventListener("click",(()=>{h(m.getValue()*d.duration)})),y.element.addEventListener("click",(()=>{d.playbackRate=Math.exp(2*(y.getValue()-.5)*Math.log(5))})),g.element.addEventListener("click",x),d.addEventListener("loadedmetadata",(()=>{v.textContent=`${s(d.currentTime)}/${s(d.duration)}`,i.classList.remove("loading")})),d.addEventListener("playing",(()=>{i.classList.remove("loading")})),d.addEventListener("waiting",(()=>{i.classList.add("loading")})),d.addEventListener("error",(()=>{i.classList.add("error")})),d.addEventListener("play",(()=>{u.classList.remove("play"),u.classList.add("pause")})),d.addEventListener("pause",(()=>{u.classList.add("play"),u.classList.remove("pause")})),d.addEventListener("ended",(()=>{u.classList.add("play"),u.classList.remove("pause")}));let b=0;return d.addEventListener("timeupdate",(()=>{const e=Date.now();e-b<500&&d.currentTime!==d.duration||(b=e,m.setValue(d.currentTime/d.duration),v.textContent=`${s(d.currentTime)}/${s(d.duration)}`)})),d.addEventListener("ratechange",(()=>{const e=d.playbackRate;y.setValue(r(e,5)),L.textContent=e.toFixed(1)})),u.addEventListener("keydown",(e=>"ArrowLeft"===e.key?(e.preventDefault(),void h(d.currentTime-10)):"ArrowRight"===e.key?(e.preventDefault(),void h(d.currentTime+10)):"ArrowUp"===e.key?(e.preventDefault(),g.setValue(r(a(g.getValue(),10)+.1,10)),void x()):"ArrowDown"===e.key?(e.preventDefault(),g.setValue(r(a(g.getValue(),10)-.1,10)),void x()):"["===e.key?(e.preventDefault(),void(d.playbackRate=Math.max(.2,d.playbackRate-.1))):"]"===e.key?(e.preventDefault(),void(d.playbackRate=Math.min(5,d.playbackRate+.1))):void 0)),d.append(await t.compileInlineSTDN(e.children)),i};var d=t.ky,l=t.hM,c=t.AS,p=t.F_,u=t.SM;export{d as createRateBar,l as player,c as prettyTime,p as rateToScale,u as scaleToRate};