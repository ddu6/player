var e={d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function a(){const e=document.createElement("div");e.classList.add("rate-bar");let t=.5;function a(){const a=100*t;e.style.background=`linear-gradient(to right, var(--color-variable) ${a}%, var(--color-pre) ${a}%)`}function n(e){isFinite(e)&&(e<0?e=0:e>1&&(e=1),t=e,a())}return e.addEventListener("click",(t=>{n(t.offsetX/e.offsetWidth)})),a(),{element:e,getValue:function(){return t},setValue:n}}function n(e,t){return Math.exp(2*(e-.5)*Math.log(t))}function r(e,t){return Math.log(e)/Math.log(t)/2+.5}function o(e){isFinite(e)||(e=0);const t=Math.floor(e%3600/60).toString().padStart(2,"0")+":"+Math.floor(e%60).toString().padStart(2,"0");return e<=3600?t:Math.floor(e/3600).toString()+":"+t}e.d(t,{ky:()=>a,F_:()=>n,SM:()=>r,AS:()=>o,hM:()=>s});const i=["autoplay","controls","crossorigin","loop","muted","poster","preload"],s=async(e,t)=>{const s=document.createElement("div"),d=document.createElement("video"),l=document.createElement("div"),c=document.createElement("div"),p=document.createElement("div"),u=document.createElement("button"),m=a(),v=document.createElement("div"),y=a(),L=document.createElement("div"),g=a(),f=document.createElement("div");function h(e){const{seekable:t}=d;for(let a=0;a<t.length;a++)if(t.start(a)<=e&&e<=t.end(a))return d.currentTime=e,void(v.textContent=`${o(d.currentTime)}/${o(d.duration)}`)}s.append(d),s.append(l),l.append(c),l.append(p),c.append(u),c.append(m.element),c.append(v),p.append(new Text("Speed")),p.append(y.element),p.append(L),p.append(new Text("Brightness")),p.append(g.element),p.append(f),l.classList.add("hide"),u.classList.add("show-icon"),u.classList.add("play"),m.setValue(0),v.textContent=`${o(0)}/${o(0)}`,L.textContent="1.0",f.textContent="1.0";const{src:E,time:k}=e.options;"string"==typeof E&&(d.src=t.context.urlToAbsURL(E,e)),"number"==typeof k&&isFinite(k)&&k>0&&h(k);for(const a of i){let n=e.options[a]??t.extractor.extractLastGlobalOption(a,"player",t.context.tagToGlobalOptions);if(!0===n&&(n=""),"string"==typeof n)try{d.setAttribute(a,n)}catch(e){console.log(e)}}function b(){const e=n(g.getValue(),10);d.style.filter=`brightness(${e})`,f.textContent=e.toFixed(1)}d.addEventListener("click",(()=>{l.classList.toggle("hide")})),u.addEventListener("click",(async()=>{u.classList.contains("pushing")||(u.classList.add("pushing"),u.classList.contains("play")?await d.play():d.pause(),u.classList.remove("pushing"))})),m.element.addEventListener("click",(()=>{h(m.getValue()*d.duration)})),y.element.addEventListener("click",(()=>{d.playbackRate=Math.exp(2*(y.getValue()-.5)*Math.log(5))})),g.element.addEventListener("click",b),d.addEventListener("loadedmetadata",(()=>{v.textContent=`${o(d.currentTime)}/${o(d.duration)}`,s.classList.remove("loading")})),d.addEventListener("playing",(()=>{s.classList.remove("loading")})),d.addEventListener("waiting",(()=>{s.classList.add("loading")})),d.addEventListener("error",(()=>{s.classList.add("error")})),d.addEventListener("play",(()=>{u.classList.remove("play"),u.classList.add("pause")})),d.addEventListener("pause",(()=>{u.classList.add("play"),u.classList.remove("pause")})),d.addEventListener("ended",(()=>{u.classList.add("play"),u.classList.remove("pause")}));let x=0;return d.addEventListener("timeupdate",(()=>{const e=Date.now();e-x<500&&d.currentTime!==d.duration||(x=e,m.setValue(d.currentTime/d.duration),v.textContent=`${o(d.currentTime)}/${o(d.duration)}`)})),d.addEventListener("ratechange",(()=>{const e=d.playbackRate;y.setValue(r(e,5)),L.textContent=e.toFixed(1)})),u.addEventListener("keydown",(e=>"ArrowLeft"===e.key?(e.preventDefault(),void h(d.currentTime-10)):"ArrowRight"===e.key?(e.preventDefault(),void h(d.currentTime+10)):"ArrowUp"===e.key?(e.preventDefault(),g.setValue(r(n(g.getValue(),10)+.1,10)),void b()):"ArrowDown"===e.key?(e.preventDefault(),g.setValue(r(n(g.getValue(),10)-.1,10)),void b()):"["===e.key?(e.preventDefault(),void(d.playbackRate=Math.max(.2,d.playbackRate-.1))):"]"===e.key?(e.preventDefault(),void(d.playbackRate=Math.min(5,d.playbackRate+.1))):void 0)),d.append(await t.compileInlineSTDN(e.children)),s};var d=t.ky,l=t.hM,c=t.AS,p=t.F_,u=t.SM;export{d as createRateBar,l as player,c as prettyTime,p as rateToScale,u as scaleToRate};